<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Sanremo 2026</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{font-family:Arial;background:#0b0b1e;color:white;padding:20px}
.box{max-width:800px;margin:auto;background:rgba(255,255,255,.05);padding:20px;border-radius:12px}
.hidden{display:none}
input,button{width:100%;padding:12px;margin:10px 0;border-radius:8px;border:none;font-size:16px}
button{background:gold;color:black;font-weight:bold;cursor:pointer}
.artist{margin:10px 0}
.bar{background:linear-gradient(90deg,gold,orange);height:26px;border-radius:8px;margin:6px 0;
line-height:26px;padding-left:10px;color:black;font-weight:bold;transition:width 1s}
#podium{display:flex;gap:20px;justify-content:center;margin:20px 0}
.podium-box{width:30%;background:gold;color:black;padding:15px;border-radius:12px;
text-align:center;font-weight:bold}
#countdown{font-size:40px;text-align:center;margin:20px 0;font-weight:bold}

/* WOW */
@keyframes wow {
  0% { transform: scale(0.5); opacity:0; box-shadow:0 0 0 gold; }
  60% { transform: scale(1.1); opacity:1; box-shadow:0 0 40px orange; }
  100% { transform: scale(1); box-shadow:0 0 15px gold; }
}
.podium-wow { animation: wow 1.2s ease-out; }

.flash { animation: flashBg 0.6s; }
@keyframes flashBg {
  0% { background:#fff; }
  100% { background:#0b0b1e; }
}
</style>
</head>
<body>

<h1>ðŸŽ¤ Sanremo 2026</h1>

<div class="box" id="login">
  <input id="nickname" placeholder="Nickname">
  <input id="code" placeholder="Codice">
  <button id="btnStart">Entra</button>
</div>

<div class="box hidden" id="vote">
  <h2>Vota tutti (1â€“10)</h2>
  <div id="artists"></div>
  <button id="btnSubmit">Invia voti</button>
</div>

<div class="box hidden" id="presenter">
  <button id="btnShow">MOSTRA CLASSIFICA</button>
  <button id="btnReveal">RIVELA PODIO</button>
  <button id="btnReset">RESET VOTI</button>
  <div id="countdown" class="hidden"></div>
  <div id="podium" class="hidden"></div>
  <div id="ranking"></div>
</div>

<script>
const PRESENTER_CODE="SANREMO26";
const artists=["Arisa","Bambole di Pezza","Chiello","Dargen","Ditonellapiaga","Eddie Brock",
"Elettra","Nigiotti","Ermal","Fedez & Masini","Renga","Fulminacci","J-Ax","LDA","Leo","Levante",
"LuchÃ¨","Malika","Mara","Maria A.","Michele","Nayt","Patty","Raf","Sal","Samurai","Sayf",
"Serena","Paradiso","Tredici"];

let votes=Array(artists.length).fill(5);
let allVotes=[];
let top3=[];
let hasVoted = localStorage.getItem("sanremo_voted")==="yes";

const nicknameEl=document.getElementById("nickname");
const codeEl=document.getElementById("code");
const login=document.getElementById("login");
const vote=document.getElementById("vote");
const presenter=document.getElementById("presenter");
const artistsDiv=document.getElementById("artists");
const ranking=document.getElementById("ranking");
const podium=document.getElementById("podium");
const countdownEl=document.getElementById("countdown");
const btnStart=document.getElementById("btnStart");
const btnSubmit=document.getElementById("btnSubmit");
const btnShow=document.getElementById("btnShow");
const btnReveal=document.getElementById("btnReveal");
const btnReset=document.getElementById("btnReset");

/* LOGIN */
btnStart.onclick=()=>{
  if(!nicknameEl.value||!codeEl.value) return alert("Compila tutto");
  login.classList.add("hidden");
  if(codeEl.value===PRESENTER_CODE) presenter.classList.remove("hidden");
  else{
    if(hasVoted){
      alert("Hai giÃ  votato da questo dispositivo!");
    }else{
      vote.classList.remove("hidden");
      renderArtists();
    }
  }
};

/* VOTO */
function renderArtists(){
  artistsDiv.innerHTML="";
  artists.forEach((a,i)=>{
    const d=document.createElement("div");
    d.className="artist";
    d.innerHTML=`${a}<input type="range" min="1" max="10" value="5"><span> 5</span>`;
    const r=d.querySelector("input"),s=d.querySelector("span");
    r.oninput=()=>{s.textContent=" "+r.value;votes[i]=+r.value;}
    artistsDiv.appendChild(d);
  });
}

btnSubmit.onclick=()=>{
  if(hasVoted){ alert("Hai giÃ  votato!"); return; }
  allVotes.push([...votes]);
  hasVoted=true;
  localStorage.setItem("sanremo_voted","yes");
  btnSubmit.disabled=true;
  btnSubmit.textContent="Voto giÃ  inviato";
  alert("Voto inviato!");
  vote.classList.add("hidden");
};

/* BEEP */
const AudioCtx=window.AudioContext||window.webkitAudioContext;
const audioCtx=new AudioCtx();
function beep(){
  const o=audioCtx.createOscillator();
  const g=audioCtx.createGain();
  o.connect(g); g.connect(audioCtx.destination);
  o.frequency.value=800; o.start();
  setTimeout(()=>o.stop(),150);
}

/* CALCOLO */
function calcolaClassifica(){
  let totals=artists.map((a,i)=>{
    let sum=0,count=0;
    allVotes.forEach(v=>{
      if(v[i]!==undefined){sum+=v[i];count++;}
    });
    return {name:a,avg:count?sum/count:0};
  }).sort((a,b)=>a.avg-b.avg);
  top3=totals.slice(-3).reverse();
  return totals.slice(0,-3);
}

/* CLASSIFICA */
btnShow.onclick=()=>{
  ranking.innerHTML="";
  if(allVotes.length===0){alert("Nessun voto inserito!");return;}
  const others=calcolaClassifica();
  const tot=artists.length;
  others.forEach((t,i)=>{
    const pos=tot-i;
    const bar=document.createElement("div");
    bar.className="bar";
    bar.style.width="5%";
    bar.textContent=`${pos}. ${t.name} â€“ 0.00`;
    ranking.appendChild(bar);
    bar.getBoundingClientRect();
    setTimeout(()=>{
      let perc=t.avg*10; if(perc<5) perc=5;
      bar.style.width=perc+"%";
      bar.textContent=`${pos}. ${t.name} â€“ ${t.avg.toFixed(2)}`;
    },50+i*40);
  });
};

/* PODIO */
btnReveal.onclick=()=>{
  calcolaClassifica();
  podium.classList.add("hidden");
  countdownEl.classList.remove("hidden");
  let n=10;
  countdownEl.textContent=n;
  beep();
  const timer=setInterval(()=>{
    n--;
    if(n>0){countdownEl.textContent=n;beep();}
    else{clearInterval(timer);countdownEl.classList.add("hidden");showPodium();}
  },1000);
};

function showPodium(){
  podium.innerHTML="";
  document.body.classList.add("flash");
  setTimeout(()=>document.body.classList.remove("flash"),600);
  top3.forEach((t,i)=>{
    const d=document.createElement("div");
    d.className="podium-box podium-wow";
    d.style.animationDelay=(i*0.2)+"s";
    d.innerHTML=`${["ðŸ¥‡","ðŸ¥ˆ","ðŸ¥‰"][i]}<br>${t.name}<br>${t.avg.toFixed(2)}`;
    podium.appendChild(d);
  });
  podium.classList.remove("hidden");
}

/* RESET */
btnReset.onclick=()=>{
  if(!confirm("Cancellare tutti i voti?")) return;
  allVotes=[];
  top3=[];
  ranking.innerHTML="";
  podium.innerHTML="";
  countdownEl.classList.add("hidden");
  localStorage.removeItem("sanremo_voted");
  hasVoted=false;
  btnSubmit.disabled=false;
  btnSubmit.textContent="Invia voti";
  alert("Voti azzerati!");
};
</script>
</body>
</html>












